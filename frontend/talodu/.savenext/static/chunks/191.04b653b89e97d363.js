"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[191],{68191:(e,s,a)=>{a.r(s),a.d(s,{default:()=>h});var l=a(95155),t=a(12115),c=a(23464),r=a(87358);let i=c.A.create({baseURL:r.env.REACT_APP_API_BASE_URL||"/api",headers:{"Content-Type":"application/json"}}),n=r.env.REACT_APP_API_PRODUCTION_BASE_URL;r.env.REACT_APP_API_IMAGES,console.log("The API base URL is: ",n),console.log("The API base URL from env is: ",r.env.REACT_APP_API_PRODUCTION_BASE_URL),r.env.REACT_APP_API_DEVELOPMENT_ENV?console.log("This is dev env"):r.env.REACT_APP_API_PRODUCTION_ENV&&console.log("we are in prod env"),i.interceptors.request.use(e=>{let s=localStorage.getItem("token");return s&&(e.headers.Authorization=`Bearer ${s}`),e}),i.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));var d=a(87358);let o=e=>{let{product:s,onSave:a,onCancel:r}=e,[i,n]=(0,t.useState)([]),[o,m]=(0,t.useState)({...s,categories:s.categories||[],shop:s.shop||i[0]||{ID:"",name:""}}),[h,x]=(0,t.useState)([]),[u,p]=(0,t.useState)(!1);(0,t.useEffect)(()=>{(async()=>{try{let e=d.env.API_BASE_URL||"http://127.0.0.1:8888",[s,a]=await Promise.all([c.A.get(e+"/categories"),c.A.get(e+"/shops")]);x(s.data),n(a.data.shops),console.log("The shops :",a.data.shops),console.log("The categories :",s.data)}catch(e){console.error("Error fetching data:",e)}})()},[]);let j=e=>{let{name:s,value:a}=e.target;m(e=>({...e,[s]:"price"===s||"stock"===s?Number(a):a}))},N=(e,s)=>{m(a=>{let l=[...a.categories||[]];if(s){let s=h.find(s=>s.ID===e);s&&l.push(s)}else{let s=l.findIndex(s=>s.ID===e);-1!==s&&l.splice(s,1)}return{...a,categories:l}})};return(0,l.jsxs)("div",{className:"card",children:[(0,l.jsx)("div",{className:"card-header",children:(0,l.jsx)("h3",{children:"Edit Product"})}),(0,l.jsx)("div",{className:"card-body",children:(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a(o)},children:[(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Name"}),(0,l.jsx)("input",{type:"text",className:"form-control",name:"name",value:o.name,onChange:j,required:!0})]}),(0,l.jsxs)("div",{className:"row mb-3",children:[(0,l.jsxs)("div",{className:"col-md-6",children:[(0,l.jsx)("label",{className:"form-label",children:"Price"}),(0,l.jsx)("input",{type:"number",className:"form-control",name:"price",value:o.price,onChange:j,min:"0",step:"0.01",required:!0})]}),(0,l.jsxs)("div",{className:"col-md-6",children:[(0,l.jsx)("label",{className:"form-label",children:"Stock"}),(0,l.jsx)("input",{type:"number",className:"form-control",name:"stock",value:o.stock,onChange:j,min:"0",required:!0})]})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Description"}),(0,l.jsx)("textarea",{className:"form-control",name:"description",value:o.description,onChange:j,rows:3})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Shop"}),(0,l.jsx)("select",{className:"form-select",name:"shop",value:o.shop?.ID,onChange:e=>{console.log("The selected product is: ",o);let s=i.find(s=>s.ID===Number(e.target.value));s&&m(e=>({...e,shop:s,ShopID:s.ID}))},required:!0,children:i.map(e=>(0,l.jsx)("option",{value:e.ID,children:e.name},e.ID))})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Categories"}),(0,l.jsx)("div",{className:"row",children:h.map(e=>(0,l.jsx)("div",{className:"col-md-4",children:(0,l.jsxs)("div",{className:"form-check",children:[(0,l.jsx)("input",{type:"checkbox",className:"form-check-input",id:`category-${e.ID}`,checked:o.categories?.some(s=>s.ID===e.ID),onChange:s=>N(e.ID,s.target.checked)}),(0,l.jsx)("label",{className:"form-check-label",htmlFor:`category-${e.ID}`,children:e.name})]})},e.ID))})]}),(0,l.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,l.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cancel"}),(0,l.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:u,children:u?"Saving...":"Save Changes"})]})]})})]})};var m=a(38543);let h=e=>{let{images:s,product:a}=e,[r,i]=(0,t.useState)(s[0]||null),[d,h]=(0,t.useState)({x:0,y:0}),[x,u]=(0,t.useState)(!1),p=(0,t.useRef)(null),[j,N]=(0,t.useState)(!1),[b,v]=(0,t.useState)(a),g="/api",f=async e=>{console.log("The prduct to update: ",e);try{let s=await c.A.put(n+`/products/${a.ID}`,e);v(s.data),console.log("The updated prduct ...: ",s.data),console.log("The updated prduct shop is ...: ",s.data.ShopID),N(!1),m.oR.success("Product updated savedsuccessfully")}catch(e){m.oR.error("Failed to update products"),console.log(e)}};return(0,l.jsxs)("div",{className:"container mt-4",children:[(0,l.jsx)("div",{children:b.name}),(0,l.jsx)("div",{className:"container mt-4",children:j?(0,l.jsx)(o,{product:b,onSave:f,onCancel:()=>N(!1)}):(0,l.jsx)(l.Fragment,{})}),(0,l.jsxs)("div",{className:"row",children:[(0,l.jsxs)("div",{className:"col-lg-8",children:[(0,l.jsx)("div",{className:"card mb-4 shadow-sm main-image-container",ref:p,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onMouseMove:e=>{if(!p.current)return;let{left:s,top:a,width:l,height:t}=p.current.getBoundingClientRect();h({x:(e.clientX-s)/l*100,y:(e.clientY-a)/t*100})},children:r?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("img",{src:g+r.url,alt:r.altText||"Product image",className:"main-product-image"}),x&&(0,l.jsx)("div",{className:"magnifier-lens",style:{left:`${d.x}%`,top:`${d.y}%`,transform:"translate(-50%, -50%)"}})]}):(0,l.jsx)("div",{className:"no-image-placeholder",children:(0,l.jsx)("span",{className:"text-muted",children:"No image selected"})})}),(0,l.jsxs)("div",{className:"thumbnail-gallery",children:[(0,l.jsx)("h5",{className:"mb-3",children:"Product Images"}),(0,l.jsx)("div",{className:"d-flex flex-row flex-nowrap overflow-auto pb-2",children:s?.length>0?s.map(e=>(0,l.jsxs)("div",{className:"thumbnail-container me-2",onClick:()=>i(e),onMouseEnter:()=>i(e),children:[(0,l.jsx)("img",{src:g+e.url,alt:e.altText||"Product thumbnail",className:`img-thumbnail ${r?.ID===e.ID?"active-thumbnail":""}`}),e.isPrimary&&(0,l.jsx)("span",{className:"badge bg-primary position-absolute top-0 start-0",children:"Primary"})]},e.ID)):(0,l.jsx)("div",{className:"alert alert-info w-100",children:"No images available for this product"})})]})]}),(0,l.jsxs)("div",{className:"col-lg-4 position-relative",children:[x&&r&&(0,l.jsx)("div",{className:"magnified-preview",style:{backgroundImage:`url(${g+r.url})`,backgroundPosition:`${d.x}% ${d.y}%`}}),(0,l.jsx)("div",{className:"card shadow-sm product-details-card",children:(0,l.jsxs)("div",{className:"card-body",children:[(0,l.jsx)("h4",{className:"card-title",children:"Product Details"}),r?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("h6",{children:"Image Information"}),(0,l.jsx)("p",{className:"text-muted small mb-1",children:r.altText||"No description available"}),(0,l.jsx)("p",{className:"small",children:r.url.split("/").pop()})]}),(0,l.jsx)("hr",{}),(0,l.jsxs)("div",{className:"d-grid gap-2",children:[(0,l.jsx)("button",{onClick:()=>N(!0),className:"btn btn-primary",children:"Edit product"}),(0,l.jsx)("button",{className:"btn btn-outline-secondary",children:"View Full Details"})]})]}):(0,l.jsx)("div",{className:"text-center text-muted py-4",children:"Select an image to see details"})]})}),(0,l.jsx)("div",{className:"card shadow-sm product-details-card",children:(0,l.jsxs)("div",{className:"card-body",children:[(0,l.jsx)("h4",{className:"card-title",children:"Product Details 2"}),r?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("h6",{children:"Image Information"}),(0,l.jsx)("p",{className:"text-muted small mb-1",children:r.altText||"No description available"}),(0,l.jsx)("p",{className:"small",children:r.url.split("/").pop()})]}),(0,l.jsx)("hr",{}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("h6",{children:"Prix"}),a.price?(0,l.jsxs)("h5",{className:"text-primary",children:["$",a.price.toFixed(2)]}):(0,l.jsx)("p",{className:"text-muted",children:"Le prix du produit n'est pas disponible"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("h6",{children:"Stock"}),a.stock?(0,l.jsxs)("h5",{className:"text-primary",children:["En Stock: ",a.stock," disponible"]}):(0,l.jsx)("p",{className:"text-muted",children:"Ce produit n'est pas disponible"})]}),r.price?(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("h6",{children:"Pricing"}),(0,l.jsxs)("h5",{className:"text-primary",children:["$",r.price.toFixed(2)]})]}):(0,l.jsx)("p",{className:"text-muted",children:"Cette version n'a pas un prix special"}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("h6",{children:"SKU"}),(0,l.jsx)("p",{className:"text-muted small",children:r.sku||"Not specified"})]}),(0,l.jsxs)("div",{className:"d-grid gap-2",children:[(0,l.jsx)("button",{className:"btn btn-primary",children:"Add to Cart"}),(0,l.jsx)("button",{className:"btn btn-outline-secondary",children:"View Full Details"})]})]}):(0,l.jsx)("div",{className:"text-center text-muted py-4",children:"Select an image to see details"})]})})]})]})]})}}}]);